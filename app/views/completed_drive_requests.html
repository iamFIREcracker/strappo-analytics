<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="//code.jquery.com/mobile/1.4.3/jquery.mobile-1.4.3.min.css"></link>
<script src="//code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="//code.jquery.com/mobile/1.4.3/jquery.mobile-1.4.3.min.js"></script>
</head>
<body>
<form method="get" data-ajax="false">
    <input type="text" name="limit" placeholder="Limit" />
    <input type="text" name="offset" placeholder="Offset" />
    <input type="submit" value="Submit" />
</form>
<h1>Drive Requests</h1>
{% for by_created_day in drive_requests | groupby('created_day') | sort(reverse=True) %}
<div data-role="collapsible">
    <h3>{{ by_created_day.grouper }}</h3>
    {% for drive_request in by_created_day.list | selectattr('driver.user') |selectattr('passenger.user') | sort(attribute='passenger.user.name') %}
    <div data-role="collapsible">
        <h3>{{ drive_request.passenger.user.name }}
            <span>
                <img src="{{ drive_request.passenger.user.avatar }}" width="24" height="24" /> 
                was taken by
                {{ drive_request.driver.user.name }}
                <span><img src="{{ drive_request.driver.user.avatar }}" width="24" height="24" /> 
                from {{ drive_request.passenger.origin }} to {{ drive_request.passenger.destination }}</h3>
        <div>
            <p>{{ drive_request.driver.id }}</p>
            <p><span><strong>Passenger name:</strong>
                <span>{{ drive_request.passenger.user.first_name }}</span> <span>{{ drive_request.passenger.user.last_name }}</span>
                </span></p>
            <p><span><strong>Driver name:</strong>
                <span>{{ drive_request.driver.user.first_name }}</span> <span>{{ drive_request.driver.user.last_name }}</span>
                </span></p>
            <p><span><strong>Origin:</strong> <span>{{ drive_request.passenger.origin }}</span></p>
            <p><span><strong>Destination:</strong> <span>{{ drive_request.passenger.destination }}</span></p>
            <p><span><strong>Seats:</strong> <span>{{ drive_request.passenger.seats }}</span></p>
        </div>
    </div>
    {% endfor %}
</div>
{% endfor %}
</body>
</html>
